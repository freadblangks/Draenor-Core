-- NPC: Coldridge Defender New locs taking from official (http://www.wowhead.com/npc=37177)
DELETE FROM `creature` WHERE `id`=37177;
INSERT INTO `creature` (`guid`,`id`,`map`,`spawnMask`,`phaseMask`,`modelid`,`equipment_id`,`position_x`,`position_y`,`position_z`,`orientation`,`spawntimesecs`,`spawndist`,`currentwaypoint`,`curhealth`,`curmana`,`isActive`,`MovementType`,`npcflag`,`unit_flags`,`dynamicflags`) VALUES
(167000, 37177, 0, 1, 1, 0, 0, -6306.83, 299.02, 378.324, 4.15479, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167001, 37177, 0, 1, 1, 1598, 0, -6258.04, 366.812, 384.264, 2.97355, 600, 0, 0, 38, 0, 0, 0, 0, 0, 0),
(167002, 37177, 0, 1, 1, 1608, 0, -6234.47, 413.267, 386.878, 2.89725, 600, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167003, 37177, 0, 1, 1, 1608, 0, -6278.35, 378.922, 382.434, 2.81727, 600, 0, 0, 32, 0, 0, 0, 0, 0, 0),
(167004, 37177, 0, 1, 1, 1598, 0, -6280.63, 399.004, 381.826, 4.65431, 600, 0, 0, 32, 0, 0, 0, 0, 0, 0),
(167005, 37177, 0, 1, 1, 1608, 0, -6280.36, 377.478, 382.304, 1.86222, 600, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167006, 37177, 0, 1, 1, 1608, 0, -6281.34, 383.975, 381.836, 4.71714, 600, 0, 0, 33, 0, 0, 0, 0, 0, 0),
(167007, 37177, 0, 1, 1, 1598, 0, -6282.31, 377.575, 382.135, 1.23862, 600, 0, 0, 32, 0, 0, 0, 0, 0, 0),
(167008, 37177, 0, 1, 1, 1598, 0, -6283.84, 317.419, 376.623, 4.10999, 600, 0, 0, 34, 0, 0, 0, 0, 0, 0),
(167009, 37177, 0, 1, 1, 1598, 0, -6309.11, 328.575, 377.75, 3.43458, 600, 0, 0, 32, 0, 0, 0, 0, 0, 0),
(166591, 37177, 0, 1, 1, 1598, 0, -6293.53, 342.741, 376.327, 1.11844, 600, 0, 0, 33, 0, 0, 0, 0, 0, 0),
(166626, 37177, 0, 1, 1, 1598, 0, -6283.41, 378.202, 382.026, 0.846702, 600, 0, 0, 33, 0, 0, 0, 0, 0, 0),
(166627, 37177, 0, 1, 1, 0, 0, -6268.96, 301.984, 382.708, 3.73851, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(166628, 37177, 0, 1, 1, 0, 0, -6253.8, 394.522, 383.389, 2.97277, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(166629, 37177, 0, 1, 1, 0, 0, -6263.2, 415.55, 385.341, 3.02225, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(166630, 37177, 0, 1, 1, 0, 0, -6289.85, 372.342, 380.669, 4.86873, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(166632, 37177, 0, 1, 1, 0, 0, -6267.71, 368.535, 382.532, 2.38373, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(166633, 37177, 0, 1, 1, 0, 0, -6267.73, 301.081, 382.885, 3.47776, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0);


-- NPC:Rockjaw Invader New locs taking from official (http://www.wowhead.com/npc=37070)
DELETE FROM `creature` WHERE `id`=37070;
INSERT INTO `creature` (`guid`,`id`,`map`,`spawnMask`,`phaseMask`,`modelid`,`equipment_id`,`position_x`,`position_y`,`position_z`,`orientation`,`spawntimesecs`,`spawndist`,`currentwaypoint`,`curhealth`,`curmana`,`isActive`,`MovementType`,`npcflag`,`unit_flags`,`dynamicflags`) VALUES
(167268, 37070, 0, 1, 1, 0, 0, -6270.19, 298.933, 382.455, 1.03125, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167269, 37070, 0, 1, 1, 0, 0, -6289.61, 370.204, 380.445, 1.60461, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167271, 37070, 0, 1, 1, 0, 0, -6308.91, 296.319, 379.249, 0.994346, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167273, 37070, 0, 1, 1, 0, 0, -6285.6, 315.531, 376.711, 0.850619, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167276, 37070, 0, 1, 1, 0, 0, -6311.35, 327.87, 377.946, 0.135906, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167278, 37070, 0, 1, 1, 0, 0, -6291.98, 344.618, 376.456, 3.9553, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167282, 37070, 0, 1, 1, 0, 0, -6260.36, 366.857, 383.891, 0.0330229, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167297, 37070, 0, 1, 1, 0, 0, -6256.16, 395.177, 383.291, 5.93922, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167352, 37070, 0, 1, 1, 0, 0, -6236.9, 413.755, 386.42, 5.99105, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167366, 37070, 0, 1, 1, 0, 0, -6266.81, 416.094, 385.174, 5.93058, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0),
(167369, 37070, 0, 1, 1, 0, 0, -6281.16, 380.162, 382.173, 1.63288, 300, 0, 0, 42, 0, 0, 0, 0, 0, 0);

-- Monster - Spear, Rusty (http://www.wowhead.com/item=2023)
-- Monster - Gun (http://www.wowhead.com/item=2552)
-- NPC: Coldridge Defender Need a equipment (http://www.wowhead.com/npc=37177)
DELETE FROM `creature_equip_template` WHERE (`entry`=37177);
INSERT INTO `creature_equip_template` (`entry`, `id`, `itemEntry1`, `itemEntry2`, `itemEntry3`) VALUES
(37177, 1, 2023, '0', 2552);

UPDATE `creature` SET `equipment_id`=1 WHERE `id`=37177;

-- Coldridge Defender
UPDATE `creature_template` SET `equipment_id`=37177 WHERE `entry`=37177;

-- NPC: Coldridge Citizen New loc taking from official (http://www.wowhead.com/npc=37218)
DELETE FROM `creature` WHERE `guid`='167039';
INSERT INTO `creature` (`guid`, `id`, `map`, `spawnMask`, `phaseMask`, `modelid`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `spawndist`, `currentwaypoint`, `curhealth`, `curmana`, `isActive`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`) VALUES 
(167039, 37218, 0, 1, 1, 30586, 0, -6097.72, 402.625, 395.539, 1.57006, 600, 0, 0, 102, 0, 0, 0, 0, 0, 0);

-- NPC: Coldridge Citizen Fix loc and movements taking from offiial (http://www.wowhead.com/npc=37218)
DELETE FROM `creature` WHERE `guid` ='167010';
INSERT INTO `creature` (`guid`, `id`, `map`, `spawnMask`, `phaseMask`, `modelid`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `spawndist`, `currentwaypoint`, `curhealth`, `curmana`, `isActive`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`) VALUES 
(167010, 37218, 0, 1, 1, 30585, 0, -6106.51, 371.738, 395.542, 5.30772, 600, 4, 0, 102, 0, 0, 1, 0, 0, 0);

-- NPC: Coldridge Citizen Fix loc, movements and gender taking from offiial (http://www.wowhead.com/npc=37218)
DELETE FROM `creature` WHERE `guid` ='167011';
INSERT INTO `creature` (`guid`, `id`, `map`, `spawnMask`, `phaseMask`, `modelid`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `spawndist`, `currentwaypoint`, `curhealth`, `curmana`, `isActive`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`) VALUES 
(167011, 37218, 0, 1, 1, 30587, 0, -6109.18, 379.636, 395.541, 1.17652, 600, 4, 0, 102, 0, 0, 1, 0, 0, 0);

DELETE FROM `creature` WHERE `guid` ='167015';
INSERT INTO `creature` (`guid`, `id`, `map`, `spawnMask`, `phaseMask`, `modelid`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `spawndist`, `currentwaypoint`, `curhealth`, `curmana`, `isActive`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`) VALUES 
(167015, 37218, 0, 1, 1, 30587, 0, -6107.15, 397.527, 395.541, 4.78071, 600, 3, 0, 102, 0, 0, 1, 0, 0, 0);

-- Delete duplicates

-- Joren Ironstock
UPDATE `creature_template` SET `unit_flags`=768, `npcflag`=2 WHERE entry=37081;
DELETE FROM `creature_equip_template` WHERE `entry`=37081;
INSERT INTO `creature_equip_template` (`entry`, `id`, `itemEntry1`, `itemEntry2`, `itemEntry3`) VALUES
(37081, 1, 1896, 0, 2510); 
UPDATE `creature_template` SET `equipment_id`=37081 WHERE `entry`=37081;
UPDATE `creature` SET `equipment_id`=1 WHERE `id`=37081;

-- Jona Ironstock
UPDATE `creature_template` SET `speed_run`=1.14286 WHERE `entry`=37087;

-- Milo's new position
UPDATE `creature` SET `position_x`=-6245.788, `position_y`=305.4635, `position_z`=383.9363, `orientation`=2.565634 WHERE `id`=37113;
UPDATE `creature_template` SET `npcflag`=0,`unit_flags`=33288,`speed_run`=2.85714,`VehicleId`=581,`InhabitType`=4,`ScriptName`= 'npc_milos_gyro' WHERE `entry`=37198;

-- Add spell click for Milo's Gyro
DELETE FROM `npc_spellclick_spells` WHERE `npc_entry`=37198;
INSERT INTO `npc_spellclick_spells` (`npc_entry`, `spell_id`, `cast_flags`, `user_type`) VALUES
(37198, 70036, 0, 0);

-- Add missing VehicleId for Milo's Gyro
UPDATE `creature_template` SET `VehicleId`=581,`InhabitType`=4 WHERE `entry`=37198;

-- Remove Milo's Gyro Quest Pack Up Your Bags
DELETE FROM `creature` WHERE `id`=37198;

-- Add missing Milo's Gyro
UPDATE `creature_template` SET `InhabitType`=4 WHERE `entry`=37169;

DELETE FROM `creature` WHERE `guid`=2500251;
INSERT INTO `creature` (`guid`, `id`, `map`, `zoneId`, `areaId`, `spawnMask`, `phaseMask`, `modelid`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `spawndist`, `currentwaypoint`, `curhealth`, `curmana`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`) VALUES
(2500251, 37169, 0, 0, 0, 1, 1, 0, 0, -6243.374, 305.5695, 384.311, 2.356194, 120, 0, 0, 1, 0, 0, 0, 0, 0);

UPDATE `creature_template` SET `unit_flags`=33555200,`InhabitType`=4 WHERE `entry`=37518;

-- Add missing auras to Milo & Milo's Gyro
DELETE FROM `creature_template_addon` WHERE `entry` IN (37113,37169);
INSERT INTO `creature_template_addon` (`entry`,`path_id`,`mount`,`bytes1`,`bytes2`,`emote`,`auras`) VALUES
(37113,0,0,0,1,0, '70045 70042'),(37169,0,0,0,1,0, '70045 70042');

-- Milo Geartwinge text
SET @ENTRY := 37518;
DELETE FROM `creature_text` WHERE `entry` IN (@ENTRY);
INSERT INTO `creature_text` (`entry`, `groupid`, `id`, `text`, `type`, `language`, `probability`, `emote`, `duration`, `sound`, `comment`) VALUES
(@ENTRY, 0, 0, '<Static>$bIs this thing on?  Hello?', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge'),
(@ENTRY, 1, 0, 'Ahh, there you are.  Hello!  I figured that, while you''re flying to Kharanos, I''d give you some data about what''s going on outside of Coldridge Valley.', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge'),
(@ENTRY, 2, 0, 'It seems you Coldridge folks are dreadfully under-informed about the events of the last few days.', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge'),
(@ENTRY, 3, 0, 'If you thought you had problems with trolls in Coldridge, wait ''til you get to Kharanos!  That big cataclysm got the trolls all stirred up out here.', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge'),
(@ENTRY, 4, 0, 'And if you''ll look to your left, you''ll see that the gnomes have retaken Gnomeregan.  Hooray for us!', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge'),
(@ENTRY, 5, 0, 'There''s plenty else going on out here, too.  We''ve opened up the path to the airport, there''s rumors of Dark Irons in the east... oh, and I think something weird is going on with that dwarf king, Magni.  Might want to check it out.', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge'),
(@ENTRY, 6, 0, 'And here we are!  Welcome to Kharanos!  Watch your step on the way out.', 12, 7, 100, 0, 0, 0, 'Milo Geartwinge');


--  Text for Hands Springsprocket
DELETE FROM `creature_text` WHERE `entry` IN ('6782'); 
INSERT INTO `creature_text` VALUES
('6782','0','0',"Alright, so you're just going to head through this tunnel and whaaaaa....?",'12','0','100','0','0','0','Hands Springsprocket - Text - Trip to Ironforge'), 
('6782','1','0',"I recommend that you return to Anvilmar, $n... and quickly! I'll send the signal to the Gnomeregan Airmen.",'12','0','100','0','0','0','Hands Springsprocket - Text - Follow the Gyrocopter accept'),
('6782','2','0',"Look for a fellow by the name of Milo Geartwinge. I suppose I'll see what I can do about this cave-in.",'12','0','100','0','0','0','Hands Springsprocket - Text - Follow the Gyrocopter accept 2');


-- Dun Morogh Mountaineer
UPDATE `creature` SET `spawndist`=0, `MovementType`=0 WHERE `id`=51912;

-- Delete wrong totems
DELETE FROM `creature` WHERE `guid` IN (373409, 373411, 373412, 373410);


-- Jona Ironstock SAI
SET @ENTRY := 37087;
UPDATE `creature_template` SET `AIName`="SmartAI" WHERE `entry`=@ENTRY;
DELETE FROM `smart_scripts` WHERE `entryorguid`=@ENTRY AND `source_type`=0;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES
(@ENTRY,0,0,0,1,0,100,0,30000,60000,150000,150000,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,"Jona Ironstock - OOC - Say 0");
-- Jona Ironstock text
DELETE FROM `creature_text` WHERE `entry`=@ENTRY;
INSERT INTO `creature_text` (`entry`, `groupid`, `id`, `text`, `type`, `language`, `probability`, `emote`, `duration`, `sound`, `comment`) VALUES
(@ENTRY, 0, 0, 'Get ta work, boys!', 12, 7, 100, 22, 0, 0, 'Jona Ironstock'),
(@ENTRY, 0, 1, 'Don''t fret, we''ll be outta here soon.', 12, 7, 100, 22, 0, 0, 'Jona Ironstock'),
(@ENTRY, 0, 2, 'Let''s keep this fire going, dwarves!', 12, 7, 100, 22, 0, 0, 'Jona Ironstock'),
(@ENTRY, 0, 3, 'What''s Joren doin'' out there, anyhow?', 12, 7, 100, 6, 0, 0, 'Jona Ironstock');

SET @ENTRY := 37081;
-- Joren Ironstock Texts
DELETE FROM `creature_text` WHERE `entry` IN (@ENTRY);
INSERT INTO `creature_text` (`entry`, `groupid`, `id`, `text`, `type`, `language`, `probability`, `emote`, `duration`, `sound`, `comment`) VALUES
(@ENTRY, 0, 0, 'Get back, ye filthy beast!', 12, 0, 100, 0, 0, 0, 'Joren Ironstock'),
(@ENTRY, 0, 1, 'Eat dwarven lead!', 12, 0, 100, 0, 0, 0, 'Joren Ironstock'),
(@ENTRY, 0, 2, 'For Ironforge!', 12, 0, 100, 0, 0, 0, 'Joren Ironstock');


-- Northshire Stormwind Infantry emote removal
UPDATE `creature_template_addon` SET `emote`=0 WHERE `entry`=49869;


-- Captain Tharran creature text fix
UPDATE `creature_text` SET `groupid`=5 WHERE `text`="Most of our steam tanks are out of commission and we're losing mountaineers quickly." AND `entry`=40950;
UPDATE `creature_text` SET `groupid`=6 WHERE `text`="We can't keep up the operation much longer. Delber and his team must launch their attack from Steelgrill's Depot as soon as possible!" AND `entry`=40950;
UPDATE `creature_text` SET `groupid`=1 WHERE `groupid`=5 AND `entry`=40950;
UPDATE `creature_text` SET `groupid`=2 WHERE `groupid`=6 AND `entry`=40950;


-- Covert Operative
SET @ENTRY := 41335;
SET @SOURCETYPE := 0;

DELETE FROM `smart_scripts` WHERE `entryorguid`=@ENTRY AND `source_type`=@SOURCETYPE;
UPDATE creature_template SET AIName="SmartAI" WHERE entry=@ENTRY LIMIT 1;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES 
(@ENTRY,@SOURCETYPE,0,0,52,0,100,0,2,40950,0,0,1,0,7000,0,0,0,0,7,0,0,0,0.0,0.0,0.0,0.0,"Start the talk"),
(@ENTRY,@SOURCETYPE,1,0,52,0,100,0,0,41335,0,0,1,1,7000,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,"Communication on table"),
(@ENTRY,@SOURCETYPE,2,0,52,0,100,0,1,41335,0,0,5,26,0,0,0,0,0,1,0,0,0,0.0,0.0,0.0,0.0,"End the text");

-- Captain Tharran
SET @ENTRY := 40950;
SET @SOURCETYPE := 0;

DELETE FROM `smart_scripts` WHERE `entryorguid`=@ENTRY AND `source_type`=@SOURCETYPE;
UPDATE creature_template SET AIName="SmartAI" WHERE entry=@ENTRY LIMIT 1;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES 
(@ENTRY,@SOURCETYPE,0,0,10,0,100,0,1,3,5000,6000,1,0,7000,0,0,0,0,7,0,0,0,0.0,0.0,0.0,0.0,"Start the talk"),
(@ENTRY,@SOURCETYPE,1,0,52,0,100,0,0,40950,0,0,1,1,7000,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,"Communication on table 1"),
(@ENTRY,@SOURCETYPE,2,0,52,0,100,0,0,40951,0,0,1,2,7000,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,"Communication on table 2"),
(@ENTRY,@SOURCETYPE,3,0,52,0,100,0,1,41335,0,0,1,3,7000,0,0,0,0,0,0,0,0,0.0,0.0,0.0,0.0,"Communication on table 3"),
(@ENTRY,@SOURCETYPE,5,0,52,0,100,0,3,40950,0,0,5,26,0,0,0,0,0,1,0,0,0,0.0,0.0,0.0,0.0,"End the talk"),
(@ENTRY,@SOURCETYPE,6,0,19,0,100,0,313,0,0,0,1,4,0,0,0,0,0,7,0,0,0,0.0,0.0,0.0,0.0,"Quest Accept - Forced to Watch from A Far - Text");


-- Quartermaster Glynna
SET @ENTRY := 40951;
SET @SOURCETYPE := 0;

DELETE FROM `smart_scripts` WHERE `entryorguid`=@ENTRY AND `source_type`=@SOURCETYPE;
UPDATE creature_template SET AIName="SmartAI" WHERE entry=@ENTRY LIMIT 1;
INSERT INTO `smart_scripts` (`entryorguid`,`source_type`,`id`,`link`,`event_type`,`event_phase_mask`,`event_chance`,`event_flags`,`event_param1`,`event_param2`,`event_param3`,`event_param4`,`action_type`,`action_param1`,`action_param2`,`action_param3`,`action_param4`,`action_param5`,`action_param6`,`target_type`,`target_param1`,`target_param2`,`target_param3`,`target_x`,`target_y`,`target_z`,`target_o`,`comment`) VALUES 
(@ENTRY,@SOURCETYPE,0,0,52,0,100,0,1,40950,0,0,1,0,7000,0,0,0,0,7,0,0,0,0.0,0.0,0.0,0.0,"Start the talk"),
(@ENTRY,@SOURCETYPE,1,0,52,0,100,0,0,40951,0,0,5,26,0,0,0,0,0,1,0,0,0,0.0,0.0,0.0,0.0,"End the talk");

